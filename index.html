<html>
<title>printCode</title>
<style>
h1, h2, h3, h4, h5, h6 { margin-bottom: 1rem; }
h6 { font-size: 1rem; }
h5 { font-size: 2rem; }
h4 { font-size: 4rem; }
h3 { font-size: 8rem; }
h2 { font-size: 16rem; }
h1 { font-size: 32rem; }
</style>
<body>

<h1>printCode</h1>

<h3>index.js</h3>
        <pre>import path from &quot;path&quot;;
import {readFile} from &quot;fs/promises&quot;;
import {glob} from &quot;glob&quot;;

const root = process.argv[2] || &quot;.&quot;;
const absoluteRoot = path.resolve(root);
const title = absoluteRoot.split(&quot;/&quot;).filter(d =&gt; d.length).at(-1);

// arbitrary initial ignore stuff, works for me, idk, i should let ppl pass this in
let ignore = [&quot;*.pdf&quot;, &quot;package-lock.json&quot;, &quot;yarn.lock&quot;, &quot;*.png&quot;, &quot;*.svg&quot;, &quot;*.jpg&quot;];
try {
  // respect .gitignore
  ignore.push(...(await readFile(path.resolve(root, &quot;.gitignore&quot;), &quot;utf8&quot;)).split(&quot;\n&quot;).filter(d =&gt; d));
} catch (e) {
  // there&apos;s no .gitignore, that&apos;s ok
}

// https://stackoverflow.com/a/30970751/120290
function escape(s) {
  let lookup = {&apos;&amp;&apos;: &quot;&amp;amp;&quot;, &apos;&quot;&apos;: &quot;&amp;quot;&quot;, &apos;\&apos;&apos;: &quot;&amp;apos;&quot;, &apos;&lt;&apos;: &quot;&amp;lt;&quot;, &apos;&gt;&apos;: &quot;&amp;gt;&quot;};
  return s.replace( /[&amp;&quot;&apos;&lt;&gt;]/g, c =&gt; lookup[c] );
}

async function getFiles(dir, level = 2) {
  const dirents = (await glob(dir + &quot;/*&quot;, {cwd: absoluteRoot, ignore, withFileTypes: true}))
    .sort((a, b) =&gt; a.name.localeCompare(b.name));
  return `${await Promise.all(dirents.map(async dirent =&gt; {
    const res = path.resolve(dir, dirent.name);
    if (dirent.isDirectory()) {
      return `&lt;h${level}&gt;${dirent.name}&lt;/h${level}&gt;
        ${await getFiles(res, level + 1)}`;
    } else {
      return `&lt;h${level + 1}&gt;${dirent.name}&lt;/h${level + 1}&gt;
        &lt;pre&gt;${escape(await readFile(res, &quot;utf8&quot;))}&lt;/pre&gt;`;
    }
  }))}`
}

process.stdout.write(`&lt;html&gt;
&lt;title&gt;${title}&lt;/title&gt;
&lt;style&gt;
h1, h2, h3, h4, h5, h6 { margin-bottom: 1rem; }
h6 { font-size: 1rem; }
h5 { font-size: 2rem; }
h4 { font-size: 4rem; }
h3 { font-size: 8rem; }
h2 { font-size: 16rem; }
h1 { font-size: 32rem; }
&lt;/style&gt;
&lt;body&gt;

&lt;h1&gt;${title}&lt;/h1&gt;

${await getFiles(root)}

&lt;/body&gt;
&lt;/html&gt;`);</pre>,<h3>package.json</h3>
        <pre>{
  &quot;name&quot;: &quot;printcode&quot;,
  &quot;type&quot;: &quot;module&quot;,
  &quot;dependencies&quot;: {
    &quot;glob&quot;: &quot;^10.3.10&quot;
  }
}
</pre>,<h3>README.md</h3>
        <pre>`node index.js ../path/to/repo &gt; index.html`
</pre>

</body>
</html>