<html>
<title>printCode</title>
<style>
h1, h2, h3, h4, h5, h6 { margin-bottom: 1rem; }
h6 { font-size: 1rem; }
h5 { font-size: 2rem; }
h4 { font-size: 4rem; }
h3 { font-size: 8rem; }
h2 { font-size: 16rem; }
h1 { font-size: 32rem; }
</style>
<body>

<h1>printCode</h1><h3>dirToPandoc.js</h3>
        <pre>// https://stackoverflow.com/questions/5827612/node-js-fs-readdir-recursive-directory-search
import path from &quot;path&quot;;
import {readFile} from &quot;fs/promises&quot;;
import {glob} from &quot;glob&quot;;

// const allowedExtensions = [&quot;js&quot;, &quot;ts&quot;, &quot;mjs&quot;, &quot;json&quot;, &quot;txt&quot;, &quot;md&quot;];

const root = process.argv[2] || &quot;.&quot;;
const absoluteRoot = path.resolve(root);
const title = absoluteRoot.split(&quot;/&quot;).filter(d =&gt; d.length).at(-1);

let doc = `&lt;html&gt;
&lt;title&gt;${title}&lt;/title&gt;
&lt;style&gt;
h1, h2, h3, h4, h5, h6 { margin-bottom: 1rem; }
h6 { font-size: 1rem; }
h5 { font-size: 2rem; }
h4 { font-size: 4rem; }
h3 { font-size: 8rem; }
h2 { font-size: 16rem; }
h1 { font-size: 32rem; }
&lt;/style&gt;
&lt;body&gt;

&lt;h1&gt;${title}&lt;/h1&gt;`;

// arbitrary initial ignore stuff, works for me, idk, i should let ppl pass this in
let ignore = [&quot;*.pdf&quot;, &quot;package-lock.json&quot;, &quot;yarn.lock&quot;, &quot;*.png&quot;, &quot;*.svg&quot;, &quot;*.jpg&quot;];
try {
  ignore.push(...(await readFile(path.resolve(root, &quot;.gitignore&quot;), &quot;utf8&quot;)).split(&quot;\n&quot;).filter(d =&gt; d));
} catch (e) {
  // ignore
}

// https://stackoverflow.com/a/30970751/120290
function escape(s) {
  let lookup = {
      &apos;&amp;&apos;: &quot;&amp;amp;&quot;,
      &apos;&quot;&apos;: &quot;&amp;quot;&quot;,
      &apos;\&apos;&apos;: &quot;&amp;apos;&quot;,
      &apos;&lt;&apos;: &quot;&amp;lt;&quot;,
      &apos;&gt;&apos;: &quot;&amp;gt;&quot;
  };
  return s.replace( /[&amp;&quot;&apos;&lt;&gt;]/g, c =&gt; lookup[c] );
}

async function getFiles(dir, level = 2) {
  const dirents = (await glob(dir + &quot;/*&quot;, {cwd: absoluteRoot, ignore, withFileTypes: true}))
    .sort((a, b) =&gt; a.name.localeCompare(b.name));
  for (const dirent of dirents) {
    const res = path.resolve(dir, dirent.name);
    if (dirent.isDirectory()) {
      doc += `&lt;h${level}&gt;${dirent.name}&lt;/h${level}&gt;`;
      await getFiles(res, level + 1);
    } else {
      doc += `&lt;h${level + 1}&gt;${dirent.name}&lt;/h${level + 1}&gt;
        &lt;pre&gt;${escape(await readFile(res, &quot;utf8&quot;))}&lt;/pre&gt;`;
    }
  }
}

await getFiles(root);

doc += &quot;&lt;/body&gt;&lt;/html&gt;&quot;;
process.stdout.write(doc);</pre><h3>index.html</h3>
        <pre></pre><h3>package.json</h3>
        <pre>{
  &quot;type&quot;: &quot;module&quot;,
  &quot;dependencies&quot;: {
    &quot;glob&quot;: &quot;^10.3.10&quot;
  }
}
</pre><h3>README.md</h3>
        <pre>To run: `node dirToPandoc.js`

Or try:

node dirToPandoc.js | pandoc -s -o test.html
node dirToPandoc.js | pandoc -s -o test.pdf --pdf-engine=/Library/TeX/texbin/pdflatex -f markdown-raw_tex
node dirToPandoc.js ../cli/src/

Links along the way:

- `git ls-files | grep &apos;\.js&apos; | xargs wc -l` https://stackoverflow.com/questions/26881441/can-you-get-the-number-of-lines-of-code-from-a-github-repository
- https://pandoc.org/MANUAL.html#pandocs-markdown
- \newpage https://stackoverflow.com/questions/16965490/pandoc-markdown-page-break
- &quot;You need to wrap your head around the idea that Git stores at least three, and sometimes up to five active copies of each file&quot; https://stackoverflow.com/questions/56235287/what-does-git-ls-files-do-exactly-and-how-do-we-remove-a-file-from-it
- https://stackoverflow.com/questions/5827612/node-js-fs-readdir-recursive-directory-search
- https://gist.github.com/lovasoa/8691344
- get a relative path: path.relative(absoluteRoot, res)
</pre><h3>test.html</h3>
        <pre>&lt;!DOCTYPE html&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; lang=&quot;&quot; xml:lang=&quot;&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta name=&quot;generator&quot; content=&quot;pandoc&quot; /&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=yes&quot; /&gt;
  &lt;title&gt;-&lt;/title&gt;
  &lt;style&gt;
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li &gt; ol, li &gt; ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, &apos;Lucida Console&apos;, monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC &gt; ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type=&quot;checkbox&quot;] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  &lt;/style&gt;
  &lt;!--[if lt IE 9]&gt;
    &lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js&quot;&gt;&lt;/script&gt;
  &lt;![endif]--&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 id=&quot;title&quot;&gt;Title&lt;/h1&gt;
&lt;h2
id=&quot;userstophdevelopmentprintcodereadme.md&quot;&gt;/Users/toph/Development/printCode/README.md&lt;/h2&gt;
&lt;p&gt;``&lt;code&gt;To run:&lt;/code&gt;node dirToPandoc.js`&lt;/p&gt;
&lt;p&gt;Links along the way:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;git ls-files | grep &apos;\.js&apos; | xargs wc -l&lt;/code&gt;
https://stackoverflow.com/questions/26881441/can-you-get-the-number-of-lines-of-code-from-a-github-repository&lt;/li&gt;
&lt;li&gt;https://pandoc.org/MANUAL.html#pandocs-markdown&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/16965490/pandoc-markdown-page-break&lt;/li&gt;
&lt;li&gt;“You need to wrap your head around the idea that Git stores at least
three, and sometimes up to five active copies of each file”
https://stackoverflow.com/questions/56235287/what-does-git-ls-files-do-exactly-and-how-do-we-remove-a-file-from-it&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/5827612/node-js-fs-readdir-recursive-directory-search&lt;/li&gt;
&lt;li&gt;https://gist.github.com/lovasoa/8691344&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;
## /Users/toph/Development/printCode/dirToPandoc.js

```// https://stackoverflow.com/questions/5827612/node-js-fs-readdir-recursive-directory-search
import path from &amp;quot;path&amp;quot;;
import {readdir, readFile} from &amp;quot;fs/promises&amp;quot;;

const allowedExtensions = [&amp;quot;js&amp;quot;, &amp;quot;ts&amp;quot;, &amp;quot;mjs&amp;quot;, &amp;quot;json&amp;quot;, &amp;quot;txt&amp;quot;, &amp;quot;md&amp;quot;];

async function* getFiles(dir) {
  const dirents = await readdir(dir, {withFileTypes: true});
  for (const dirent of dirents) {
    const res = path.resolve(dir, dirent.name);
    if (dirent.isDirectory()) {
      yield* getFiles(res);
    } else {
      yield res;
    }
  }
}

(async () =&amp;gt; {
  let md = &amp;quot;# Title&amp;quot;
  for await (const f of getFiles(&amp;quot;.&amp;quot;)) {
    if (allowedExtensions.includes(f.split(&amp;quot;.&amp;quot;).at(-1))) {
      md += ` \n\n## ${f}\n\n\`\`\``
      md += (await readFile(f, &amp;quot;utf8&amp;quot;));
      md += &amp;quot;\`\`\`&amp;quot;
    }
  }
  md += &amp;quot;\n &amp;quot;
  process.stdout.write(md);
})();&lt;/code&gt;&lt;/pre&gt;
&lt;h2
id=&quot;userstophdevelopmentprintcodepackage.json&quot;&gt;/Users/toph/Development/printCode/package.json&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;{   &quot;type&quot;: &quot;module&quot; }&lt;/code&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></body></html>